# 水印文件本地应用 PRD 文档

## 产品概述

### 产品名称
水印文件本地应用 (Watermark Desktop App)

### 产品定位
一款功能强大的桌面水印应用，支持Windows和macOS平台，为用户提供便捷的图片水印添加功能。

### 目标用户
- 摄影师和设计师
- 内容创作者
- 企业用户
- 个人用户

### 核心价值
- 简单易用的图形界面
- 强大的水印定制功能
- 批量处理能力
- 实时预览效果

---

## 功能需求

### 1. 文件处理模块

#### 1.1 导入图片
**功能描述**: 支持多种方式导入图片文件

**详细需求**:
- **单张图片导入**
  - 支持拖拽操作：用户可直接将图片文件拖拽到应用窗口
  - 文件选择器：通过"打开文件"按钮选择单张图片

- **批量导入**
  - 多选模式：按住Ctrl/Cmd键选择多张图片
  - 文件夹导入：选择整个文件夹，自动导入所有支持的图片格式
  - 批量拖拽：同时拖拽多个图片文件

- **图片列表显示**
  - 缩略图预览：显示图片的小尺寸预览图
  - 文件名显示：显示原始文件名

**界面要求**:
- 图片列表区域占据左侧或上方30%空间
- 缩略图尺寸：80x80像素

#### 1.2 支持格式
**输入格式**:
- **必须支持**: JPEG, PNG
- **强烈建议支持**: BMP, TIFF
- **特殊要求**: PNG格式必须支持透明通道

**输出格式**:
- JPEG格式（默认）
- PNG格式（支持透明通道）
- 用户可在设置中选择默认输出格式

**格式转换**:
- 自动处理格式转换
- 保持图片质量
- 透明通道处理

#### 1.3 导出图片
**输出位置**:
- 用户可指定输出文件夹
- 默认禁止导出到原文件夹（防止覆盖）
- 提供"选择输出文件夹"按钮
- 记住上次使用的输出文件夹

**文件命名规则**:
- **保留原文件名**: 默认选项
- **添加前缀**: 用户可设置自定义前缀（如"wm_"）
- **添加后缀**: 用户可设置自定义后缀（如"_watermarked"）
- **时间戳**: 可选择添加时间戳
- **序号**: 批量处理时可添加序号

**高级功能** (可选):
- **JPEG质量调节**: 0-100滑块控制压缩率
- **图片尺寸调整**: 
  - 按宽度缩放
  - 按高度缩放
  - 按百分比缩放
  - 保持宽高比选项

### 2. 水印类型模块

#### 2.1 文本水印
**基础功能**:
- **内容输入**: 多行文本输入框，支持换行
- **字体选择**: 下拉菜单选择系统已安装字体
- **字号设置**: 数字输入框，范围10-500px
- **颜色选择**: 调色板选择器，支持RGB/HEX输入
- **透明度**: 滑块控制，范围0-100%

**高级功能** (可选):
- **字体样式**: 粗体、斜体、下划线选项
- **阴影效果**: 
  - 阴影颜色选择
  - 阴影偏移量设置
  - 阴影模糊半径
- **描边效果**:
  - 描边颜色选择
  - 描边宽度设置
- **背景框**: 可选添加半透明背景框

#### 2.2 图片水印 (可选高级功能)
**基础功能**:
- **图片选择**: 从本地选择图片文件作为水印
- **透明通道**: 必须支持PNG透明通道
- **缩放控制**: 按比例或自由调整大小
- **透明度**: 0-100%透明度调节

**高级功能**:
- **旋转**: 任意角度旋转
- **滤镜效果**: 黑白、复古等效果
- **混合模式**: 正常、叠加、柔光等模式

### 3. 水印布局与样式模块

#### 3.1 实时预览
**预览窗口**:
- 占据界面主要区域（60-70%空间）
- 实时显示水印效果
- 支持缩放：100%、75%、50%、25%
- 支持拖拽移动视图
- 显示图片原始尺寸信息

**预览功能**:
- 点击图片列表切换预览
- 键盘方向键切换图片
- 鼠标滚轮缩放
- 右键菜单快速操作

#### 3.2 位置控制
**预设位置**:
- 九宫格布局：左上、中上、右上、左中、正中、右中、左下、中下、右下
- 一键定位按钮
- 位置指示器显示

**手动拖拽**:
- 鼠标拖拽水印到任意位置
- 实时显示位置坐标
- 吸附到边缘功能
- 网格对齐辅助

#### 3.3 旋转功能 (可选高级功能)
**旋转控制**:
- 滑块控制：-180°到+180°
- 数字输入框：精确角度输入
- 预设角度：0°、90°、180°、270°
- 旋转中心点设置

### 4. 配置管理模块

#### 4.1 水印模板
**模板保存**:
- 保存当前所有水印设置
- 模板命名：用户自定义名称
- 模板描述：可选添加描述信息
- 模板预览：显示模板效果图

**模板管理**:
- 模板列表：显示所有已保存模板
- 加载模板：一键应用模板设置
- 删除模板：确认后删除
- 导入/导出模板：与其他用户分享

**自动加载**:
- 启动时加载上次设置
- 默认模板设置
- 快速应用最近使用的模板

---

## 技术需求

### 开发平台
- **Windows**: .NET Framework 4.8+ 或 .NET 6+
- **macOS**: Xamarin.Mac 或 .NET 6+ (跨平台)

### 推荐技术栈
- **前端框架**: WPF (Windows) / Avalonia (跨平台)
- **图像处理**: ImageSharp 或 SkiaSharp
- **UI组件**: Material Design 或 Fluent Design

### 性能要求
- 支持处理大尺寸图片（4K+）
- 批量处理时显示进度条
- 内存使用优化
- 响应式界面

### 兼容性
- **Windows**: Windows 10/11
- **macOS**: macOS 10.15+
- 支持高DPI显示
- 支持多显示器

---

## 用户界面设计

### 主界面布局
```
┌─────────────────────────────────────────────────────────┐
│ 菜单栏: 文件 编辑 视图 帮助                                │
├─────────────┬───────────────────────────────────────────┤
│ 图片列表    │              预览区域                      │
│ - 缩略图1   │                                           │
│ - 缩略图2   │            [主预览窗口]                   │
│ - 缩略图3   │                                           │
│ ...         │                                           │
├─────────────┼───────────────────────────────────────────┤
│ 水印设置    │              输出设置                      │
│ - 文本内容  │            - 输出文件夹                    │
│ - 字体设置  │            - 文件命名                     │
│ - 颜色/透明 │            - 格式/质量                    │
│ - 位置控制  │            - 批量处理                     │
└─────────────┴───────────────────────────────────────────┘
```

### 关键界面元素
1. **工具栏**: 导入、导出、撤销、重做、设置
2. **状态栏**: 显示当前图片信息、处理进度
3. **侧边栏**: 水印设置面板
4. **预览区**: 主预览窗口，支持缩放和拖拽

---

## 用户体验需求

### 操作流程
1. **导入图片** → 2. **设置水印** → 3. **预览效果** → 4. **导出图片**

### 快捷键支持
- `Ctrl+O`: 打开文件
- `Ctrl+S`: 保存设置
- `Ctrl+Z`: 撤销
- `Ctrl+Y`: 重做
- `Space`: 播放/暂停预览
- `Delete`: 删除选中图片

### 错误处理
- 友好的错误提示
- 操作确认对话框
- 自动保存功能
- 崩溃恢复机制

---

## 发布计划

### 版本规划
- **v1.0**: 基础功能（文本水印、批量处理）
- **v1.1**: 图片水印、高级字体设置
- **v1.2**: 模板管理、高级效果
- **v2.0**: 跨平台支持、云端同步

### 里程碑
1. **需求确认** (1周)
2. **UI设计** (2周)
3. **核心开发** (8周)
4. **测试优化** (2周)
5. **发布上线** (1周)

---

## 成功指标

### 功能指标
- 支持10+种图片格式
- 处理速度：单张图片<2秒
- 批量处理：100张图片<5分钟
- 内存使用：<500MB

### 用户体验指标
- 界面响应时间<100ms
- 学习成本：新用户5分钟内完成首次水印添加
- 用户满意度>4.5/5.0

---

## 风险评估

### 技术风险
- 大图片处理性能
- 跨平台兼容性
- 内存泄漏问题

### 解决方案
- 分块处理大图片
- 充分测试多平台
- 定期内存检查

---

*文档版本: v1.0*  
*创建日期: 2025年9月24日*  
*最后更新: 2025年9月24日*
